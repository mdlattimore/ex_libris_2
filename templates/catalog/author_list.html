{#{% extends "_base.html" %}#}
{##}
{##}
{##}
{#{% block content %}#}
{#    <br>#}
{#    <h1 class="text-center mb-4">Authors</h1>#}
{##}
{##}
{#    <div class="list-group shadow-sm">#}
{#        {% for author in authors_display %}#}
{#            <a href="{% url 'author_detail' author.pk %}"#}
{#               class="list-group-item list-group-item-action d-flex align-items-start gap-3 catalog-item"#}
{#               style="max-height: 107px; min-height: 107px;">#}
{#                {% if author.author_image_url %}#}
{#                    <img src="{{ author.author_image_url }}" alt="{{ author.full_name }}"#}
{#                         style="width:60px;height:auto;margin-right:15px;"#}
{#                         class="rounded shadow-sm">#}
{#                {% else %}#}
{#                    <div class="me-3 d-flex align-items-center justify-content-center bg-light border rounded text-muted"#}
{#                         style="width:60px; height:90px; font-size:.8em;">#}
{#                        {{ author.full_name }}#}
{#                    </div>#}
{#                {% endif %}#}
{#                <div class="flex-fill">#}
{#                    <h6 class="mb-0">{{ author.full_name }}</h6>#}
{#                    <small class="text-muted">{{ author.nationality }}</small><br>#}
{#                    <small>{{ author.dob.year }} - {{ author.dod.year }}</small><br>#}
{#                </div>#}
{#            </a>#}
{#        {% endfor %}#}
{#    </div>#}
{##}
{##}
{##}
{#{% endblock content %}#}
{##}

{% extends "_base.html" %}

{% block content %}
<br>
<h1 class="text-center mb-4">Authors</h1>

<div class="list-group shadow-sm">

    {% for author in authors_display %}

        <div class="list-group-item list-group-item-action d-flex justify-content-between align-items-start gap-3 catalog-item position-relative outer-link"
             data-url="{% url 'author_detail' author.pk %}"
             style="min-height: 107px;">

            <!-- LEFT SIDE: Author image + metadata -->
            <div class="d-flex align-items-start">

                {% if author.author_image_url %}
                    <img src="{{ author.author_image_url }}"
                         alt="{{ author.full_name }}"
                         class="rounded shadow-sm me-3"
                         style="width:60px;height:auto;">
                {% else %}
                    <div class="me-3 d-flex align-items-center justify-content-center bg-light border rounded text-muted"
                         style="width:60px; height:90px; font-size:.8em;">
                        {{ author.full_name }}
                    </div>
                {% endif %}

                <div class="flex-fill">
                    <h6 class="mb-0">{{ author.full_name }}</h6>
                    <small class="text-muted">{{ author.nationality }}</small><br>

                    {% if author.dob and author.dod %}
                        <small>{{ author.dob.year }} – {{ author.dod.year }}</small>
                    {% elif author.dob %}
                        <small>{{ author.dob.year }}</small>
                    {% endif %}
                </div>
            </div>

            <!-- RIGHT SIDE: Scrollable row of volume thumbnails -->
{#            <div class="d-flex flex-nowrap overflow-auto align-items-start ms-3">#}
{##}
                {# Loop over author's Works, then each Work’s Volumes #}
{#                {% for work in author.works.all %}#}
{#                    {% for vol in work.volumes.all %}#}
{##}
{#                        {% if vol.cover_url %}#}
{#                            <a href="{% url 'volume_detail' vol.pk %}">#}
{#                                <img src="{{ vol.cover_url }}"#}
{#                                     alt="{{ vol.title }}"#}
{#                                     class="rounded ms-1"#}
{#                                     style="height:100px; width:auto; object-fit:cover;">#}
{#                            </a>#}
{#                        {% else %}#}
{#                            <a href="{% url 'volume_detail' vol.pk %}" class="ms-1 text-decoration-none">#}
{#                                <div class="d-flex align-items-center justify-content-center bg-light border rounded text-muted p-1"#}
{#                                     style="width:78px; height:100px; font-size:.8em; overflow:hidden;">#}
{#                                    {{ vol.title|truncatechars:20 }}#}
{#                                </div>#}
{#                            </a>#}
{#                        {% endif %}#}
{##}
{#                    {% endfor %}#}
{#                {% endfor %}#}
{#            </div>#}

        <div class="d-flex flex-nowrap overflow-auto align-items-start ms-3">
    {% for vol in author.unique_volumes %}
        {% if vol.cover_url %}
            <a href="{% url 'volume_detail' vol.pk %}">
                <img src="{{ vol.cover_url }}"
                     alt="{{ vol.title }}"
                     class="rounded ms-1"
                     style="height:100px; width:auto; object-fit:cover;">
            </a>
        {% else %}
            <a href="{% url 'volume_detail' vol.pk %}" class="ms-1 text-decoration-none">
                <div class="d-flex align-items-center justify-content-center bg-light border rounded text-muted p-1"
                     style="width:78px; height:100px; font-size:.8em; overflow:hidden;">
                    {{ vol.title|truncatechars:20 }}
                </div>
            </a>
        {% endif %}
    {% endfor %}
</div>


        </div>

    {% endfor %}
</div>


<!-- Outer-link click handler (same as work_list) -->
<script>
    document.addEventListener("click", function (e) {
        const item = e.target.closest(".outer-link");
        if (!item) return;

        // If user clicked a real <a> (volume link), do NOT trigger outer link
        if (e.target.closest("a")) return;

        // Otherwise clicking anywhere else navigates to the author
        window.location = item.dataset.url;
    });
</script>

{% endblock content %}
