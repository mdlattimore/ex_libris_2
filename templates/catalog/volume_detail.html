{% extends "_base.html" %}
{% load thumbnail %}
{% load md_tags %}
{% load humanize %}
{% block content %}
    <br>
    <h1 class="text-center"><i>{{ volume.title }}</i></h1>
    {% if volume.description %}
        <p>{{ volume.description }}</p>
    {% endif %}
    <br>
    <div class="row">
        <div class="col-md-6">
            <div class="card">
                <div class="card-header fw-semibold text-center">Bibliographic Info</div>
                <div class="card-body">
                    {#            <div class="row">#}
                    {#                <div class="col-sm-4">Author:</div>#}
                    {#                <div class="col-sm-8 fw-bolder">{{ volume.works.all.0.author }}</div>#}
                    {#            </div>#}
                    {% if volume.collection.exists %}
                        <div class="row">
                            <div class="col-sm-4">Collection:</div>
                            <div class="col-sm-8 fw-bolder">
                                {% for coll in volume.collection.all %}
                                    <a href="{% url 'collection_detail' coll.pk %}">{{ coll.name }}</a>
                                    {% if not forloop.last %}, {% endif %}
                                {% endfor %}
                            </div>
                        </div>
                    {% endif %}


                    {% with first_work=volume.works.first %}
                        {% if first_work %}
                            <div class="row">
                                <div class="col-sm-4">Author:</div>
                                <div class="col-sm-8 fw-bolder"><a
                                        href="{% url 'author_detail' first_work.author.pk %}">{{ first_work.author }}</a>
                                </div>
                            </div>
                        {% endif %}
                    {% endwith %}

                    {% if volume.illustrator %}
                        <div class="row">
                            <div class="col-sm-4">Illustrator:</div>
                            <div class="col-sm-8 fw-bolder">{{ volume.illustrator }}</div>
                        </div>
                    {% endif %}
                    <div class="row">
                        <div class="col-sm-4">Published:</div>
                        <div class="col-sm-8 fw-bolder">{{ volume.publication_year }}</div>
                    </div>
                    <div class="row">
                        <div class="col-sm-4">Publisher:</div>
                        <div class="col-sm-8 fw-bolder">{{ volume.publisher }}</div>
                    </div>
                    {% if volume.book_set %}
                        <div class="row">
                            <div class="col-sm-4">Book Set:</div>
                            <div class="col-sm-8 fw-bolder"><a
                                    href="{% url 'bookset_detail' volume.book_set.pk %}">{{ volume.book_set }}</a></div>
                        </div>
                        {% if volume.volume_number %}
                            <div class="row">
                                <div class="col-sm-4">Volume:</div>
                                <div class="col-sm-8 fw-bolder">{{ volume.volume_number|default:"" }}</div>
                            </div>
                        {% endif %}
                    {% endif %}
                    {% if volume.edition %}
                        <div class="row">
                            <div class="col-sm-4">Edition:</div>
                            <div class="col-sm-8 fw-bolder">{{ volume.edition }}</div>
                        </div>
                    {% endif %}
                    <div class="row">
                        <div class="col-sm-4">ISBN10:</div>
                        <div class="col-sm-8 fw-bolder">{{ volume.isbn10 }}</div>
                    </div>
                    <div class="row">
                        <div class="col-sm-4">ISBN13:</div>
                        <div class="col-sm-8 fw-bolder">{{ volume.isbn13 }}</div>
                    </div>
                    <div class="row">
                        <div class="col-sm-4">Volume Type:</div>
                        <div class="col-sm-8 fw-bolder">{{ volume.get_volume_content_type_display }}</div>
                    </div>
                    <div class="row">
                        <div class="col-sm-4">Edition Type:</div>
                        <div class="col-sm-8 fw-bolder">{{ volume.get_volume_edition_type_display }}</div>
                    </div>
                    <div class="row">
                        <div class="col-sm-4">Genre(s):</div>
                        <div class="col-sm-8 fw-bolder">
                            {% if genres %}
                                {% for genre in genres %}
                                    {{ genre }}{% if not forloop.last %}<br>{% endif %}
                                {% endfor %}
                            {% else %}
                                <span class="text-muted">No associated genres</span>
                            {% endif %}
                        </div>
                    </div>
                    {#                    <div class="row">#}
                    {#                        <div class="col-sm-4">Works:</div>#}
                    {#                        <div class="col-sm-8 fw-bolder">#}
                    {#                            {% for work in volume.works.all %}#}
                    {#                                <a href="{% url 'work_detail' work.pk %}">{{ work }}</a><br>#}
                    {#                            {% endfor %}#}
                    {#                        </div>#}
                    {#                    </div>#}
                    <hr class="my-2">
                    <div class="row">
                        <div class="col-sm-4">Works:</div>
                        <div class="col-sm-8 fw-bolder">
                            {% for work in volume.works.all %}
                                <a href="{% url 'work_detail' work.pk %}">{{ work }}</a>{% if not forloop.last %}<br>
                            {% endif %}
                            {% empty %}
                                <span class="text-muted">No associated works</span>
                            {% endfor %}
                        </div>
                    </div>

                </div>
            </div>
            <div class="card">
                <div class="card-header fw-semibold text-center">Volume Description and Condition</div>
                <div class="card-body">
                    <div class="row">
                        <div class="col-sm-4">Binding:</div>
                        <div class="col-sm-8 fw-bolder">{{ volume.get_binding_display }}</div>
                    </div>
                    <div class="row">
                        <div class="col-sm-4">Condition:</div>
                        <div class="col-sm-8 fw-bolder">{{ volume.get_condition_display }}</div>
                    </div>
                    <div class="row">
                        <div class="col-sm-4">Dust Jacket:</div>
                        <div class="col-sm-8 fw-bolder">{{ volume.dust_jacket|yesno:"Yes,No" }}</div>
                    </div>
                    <div class="row">
                        <div class="col-sm-4">DJ Condition:</div>
                        <div class="col-sm-8 fw-bolder">
                            {% if volume.get_dust_jacket_condition_display %}
                                {{ volume.get_dust_jacket_condition_display }}
                            {% else %}
                                <span class="text-muted fst-italic">—</span>
                            {% endif %}
                        </div>
                    </div>
                    {% if volume.notes %}
                        <div class="row">
                            <div class="col-sm-4">Notes:</div>
                            <div class="col-sm-8 fw-bolder">{{ volume.notes_html|safe }}</div>
                        </div>
                    {% endif %}

                </div>
            </div>
            <div class="card">
                <div class="card-header fw-semibold text-center">Collection Data</div>
                <div class="card-body">
                    <div class="row">
                        <div class="col-sm-4">Acquisition Date:</div>
                        <div class="col-sm-8 fw-bolder">{{ volume.acquisition_date }}</div>
                    </div>
                    <div class="row">
                        <div class="col-sm-4">Acquisition year:</div>
                        <div class="col-sm-8 fw-bolder">{{ volume.acquisition_year }}</div>
                    </div>
                    <div class="row">
                        <div class="col-sm-4">Source:</div>
                        <div class="col-sm-8 fw-bolder">{{ volume.source }}</div>
                    </div>
                    <div class="row">
                        <div class="col-sm-4">Price:</div>
                        <div class="col-sm-8 fw-bolder">
                            {% if volume.price %}
                                ${{ volume.price|intcomma }}
                            {% else %}
                                <span class="text-muted fst-italic">—</span>
                            {% endif %}
                        </div>
                    </div>
                    <div class="row">
                        <div class="col-sm-4">Estimated Value:</div>
                        <div class="col-sm-8 fw-bolder">
                            {% if volume.estimated_value %}
                                ${{ volume.estimated_value|intcomma }}
                            {% else %}
                                <span class="text-muted fst-italic">—</span>
                            {% endif %}
                        </div>
                    </div>
                    {% if volume.edition_notes %}
                        <div class="row">
                            <div class="col-sm-4">Edition Notes:</div>
                            <div class="col-sm-8 fw-bolder">{{ volume.edition_notes_html|safe }}</div>
                        </div>
                    {% endif %}
                </div>
            </div>
            <div class="card">
                <div class="card-header fw-semibold text-center">Disposition</div>
                <div class="card-body">
                    <div class="row">
                        <div class="col-sm-4">Coming</div>
                        <div class="col-sm-8 fw-bolder">Soon</div>
                    </div>
                </div>
            </div>

        </div>
        <div class="col-md-6">
            <img src="{{ volume.cover_url }}" class="rounded mx-auto d-block" alt="Cover"></div>
    </div>
    <br>
    {% if user.is_authenticated %}
        <a href="{% url 'volume_update' volume.pk %}" class="btn btn-primary">Update</a>
    {% endif %}
    <br>
    <br>
{% endblock content %}