{% extends "_base.html" %}

{% block content %}
    <br>
    <h1 class="display-5 text-center">{{ bookset.title }} Set</h1>
    <p class="lead text-justify" style="font-size: 1em;">{{ bookset.description }}</p>
    {#        {% if bookset.cover_url %}#}
    {#            <img src="{{ bookset.cover_url }}" alt="Book Set" class="d-block mx-auto" style="max-height:150px; width:auto;">#}
    {#        {% endif %}#}
    {% if bookset.cover_src %}
        <div class="d-block mx-auto">
            <img
                    src="{{ bookset.cover_src }}"
                    class="rounded mx-auto d-block img-fluid"
                    alt="Cover"
                    style="max-height:300px; width:auto">
            {% if bookset.cover_is_stock %}
                <span class="badge position-absolute bottom-0 end-0 m-1"
                      style="background: rgba(0,0,0,0.35); font-size: 0.65rem; font-weight: 500;">
                        Stock Image
                </span>
            {% endif %}
        </div>
    {% else %}
        <span class="text-muted fst-italic">No cover image</span>
    {% endif %}
    <br>
    <div class="list-group shadow-sm">
        {#        {% for volume in sorted_bookset %}#}
        {#            <a href="{% url 'volume_detail' volume.pk %}"#}
        {#               class="list-group-item list-group-item-action d-flex align-items-start gap-3 catalog-item">#}
        {#                {% if volume.cover_url %}#}
        {#                    <img src="{{ volume.cover_url }}" alt="{{ volume.title }}" style="width:80px;height:auto;"#}
        {#                         class="rounded shadow-sm">#}
        {#                {% else %}#}
        {#                    <div class="bg-light rounded d-flex align-items-center justify-content-center"#}
        {#                         style="width:80px;height:120px;">#}
        {#                        <i class="bi bi-book text-muted fs-2"></i>#}
        {#                    </div>#}
        {#                {% endif %}#}
        {#                <div class="flex-fill">#}
        {#                    <h6 class="mb-0">{% if volume.volume_number %}#}
        {#                        Vol {{ volume.volume_number }} -#}
        {#                    {% endif %}{{ volume.title }}</h6>#}
        {#                    <small class="text-muted">{{ volume.works.first.author }}</small><br>#}
        {#                    <small>{{ volume.publisher }} ({{ volume.publication_year }})</small><br>#}
        {#                    {% if volume.edition %}<small>{{ volume.edition }}</small>{% endif %}#}
        {#                </div>#}
        {#            </a>#}
        {#        {% endfor %}#}
        <div class="row g-3">
            {% for volume in sorted_bookset %}
                <div class="col-md-6 col-lg-4">
                    <a href="{{ volume.get_absolute_url }}" class="text-decoration-none text-reset">
                        {% include "partials/volume_card.html" %}
                    </a>
                </div>
            {% endfor %}
        </div>
    </div>
    <br><br>
    {% if bookset.is_box_set %}
        <div class="row">
            {% if bookset.left_image %}
                <div class="col">
                    <h1 class="display-6">Box Left Image</h1>
                    <img
                            src="{{ bookset.left_image.image_display.url }}"
                            class="img-fluid rounded shadow-sm volume-thumb"
                            alt="{{ bookset.left_image.caption }}"
                            style="max-height: 300px; width:auto">
                </div>
            {% endif %}
            {% if bookset.spine_image %}
                <div class="col">
                    <h1 class="display-6">Box Spine Image</h1>

                    <img
                            src="{{ bookset.spine_image.image_display.url }}"
                            class="img-fluid rounded shadow-sm volume-thumb"
                            alt="{{ bookset.spine_image.caption }}"
                            style="max-height: 300px; width:auto">
                </div>
            {% endif %}
            {% if bookset.right_image %}
                <div class="col">
                    <h1 class="display-6">Box Right Image</h1>
                    <img
                            src="{{ bookset.right_image.image_display.url }}"
                            class="img-fluid rounded shadow-sm volume-thumb"
                            alt="{{ bookset.right_image.caption }}"
                            style="max-height: 300px; width:auto">
                </div>
            {% endif %}
        </div>
    {% endif %}
    <br><br>
    {% if bookset.other_images %}
        <h1 class="display-6 text-center">Other Images</h1>
                <div class="row g-2">
                    {% for img in bookset.other_images.all %}
                        <div class="col-6 col-md-3">
                            <img
                                    src="{{ img.image_thumb.url }}"
                                    class="img-fluid rounded shadow-sm volume-thumb"
                                    alt="{{ img.caption|default:'Image' }}"
                            >
                        </div>
                    {% endfor %}
                </div>
    {% endif %}
    {% if user.is_authenticated %}
        <p>{{ bookset.notes|linebreaks }}</p>
    {% endif %}
    <br>
    {# Upload button #}
            {% if user.is_authenticated %}
                <div class="text-center mb-3">
                    <a href="{% url 'bookset_image_add' bookset.slug %}" class="btn btn-outline-primary btn-sm">
                        Add photos
                    </a>
                </div>
            {% endif %}
{% endblock %}
